:root {
  --bg: #0f1115;
  --panel: #171923;
  --card: #1f2230;
  --text: #e6e6e9;
  --muted: #a3a3aa;
  --accent: #4fae4a;
  --danger: #ef4444;
  --warning: #f59e0b;
  --outline: #2b2f42;
}
* { box-sizing: border-box; }
body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Noto Sans;
  background: linear-gradient(180deg, #0f1115, #0b0d12); color: var(--text); }
header.app-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:var(--panel);border-bottom:1px solid var(--outline);position:sticky;top:0;z-index:5;}
header h1{font-size:18px;margin:0;}
header .actions{display:flex;gap:8px;}
button{background:var(--card);color:var(--text);border:1px solid var(--outline);padding:8px 12px;border-radius:8px;cursor:pointer;}
button[disabled]{opacity:.6;cursor:not-allowed;}
.layout{display:grid;grid-template-columns:320px 1fr;min-height:calc(100vh - 64px);}
.sidebar{border-right:1px solid var(--outline);padding:16px;background:var(--panel);}
.sidebar h2{margin:0 0 8px;font-size:14px;color:var(--muted);}
.muted{color:var(--muted);font-size:12px;margin-bottom:8px;}
#projectsSelect{width:100%;padding:8px;background:var(--card);border:1px solid var(--outline);border-radius:8px;color:var(--text);font-size:14px;}
#projectsSelect:disabled{opacity:0.6;cursor:not-allowed;}
#projectsSelect option{background:var(--card);color:var(--text);}
.content{padding:20px;}
.cards{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:16px;}
.card{background:var(--card);border:1px solid var(--outline);border-radius:12px;padding:14px;}
.card h3{margin:0 0 6px;font-size:13px;color:var(--muted);}
.card .value{font-size:20px;font-weight:700;}
.badge{display:inline-block;padding:2px 6px;border-radius:999px;font-size:11px;border:1px solid var(--outline);}
.badge.ok{background:rgba(79,174,74,.15);} .badge.warn{background:rgba(245,158,11,.15);} .badge.danger{background:rgba(239,68,68,.15);}
.controls{margin:12px 0;}
.section{margin-bottom:16px;}
.section .head{display:flex;align-items:center;justify-content:space-between;background:var(--panel);border:1px solid var(--outline);border-radius:10px 10px 0 0;padding:10px 12px;}
.section .body{border:1px solid var(--outline);border-top:0;background:var(--card);padding:12px;border-radius:0 0 10px 10px;}
table.filelist{width:100%;border-collapse:collapse;font-size:12px;}
table.filelist th,table.filelist td{text-align:left;padding:6px 8px;border-bottom:1px solid var(--outline);}
.footer{padding:10px 16px;border-top:1px solid var(--outline);background:var(--panel);}
code{background:#12131a;padding:1px 4px;border-radius:4px;border:1px solid var(--outline);}

/* Text Display Modal */
.text-display-modal{position:fixed;inset:0;z-index:100;display:flex;align-items:center;justify-content:center;}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(4px);}
.modal-content{position:relative;width:90%;max-width:900px;max-height:80vh;background:var(--panel);border:1px solid var(--outline);border-radius:12px;display:flex;flex-direction:column;overflow:hidden;}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--outline);background:var(--card);}
.modal-header h3{margin:0;font-size:14px;}
.modal-close{background:transparent;border:1px solid var(--outline);color:var(--muted);width:28px;height:28px;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;}
.modal-close:hover{background:var(--card);color:var(--text);}
.modal-body{flex:1;overflow:auto;padding:16px;}
.text-display{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,monospace;font-size:13px;line-height:1.6;}
.text-display.markdown{font-family:inherit;}
.text-display.markdown h1{font-size:24px;margin:16px 0;color:var(--text);border-bottom:1px solid var(--outline);padding-bottom:8px;}
.text-display.markdown h2{font-size:20px;margin:14px 0;color:var(--text);border-bottom:1px solid var(--outline);padding-bottom:6px;}
.text-display.markdown h3{font-size:16px;margin:12px 0;color:var(--text);}
.text-display.markdown h4{font-size:14px;margin:10px 0;color:var(--text);}
.text-display.markdown h5{font-size:13px;margin:8px 0;color:var(--text);}
.text-display.markdown h6{font-size:12px;margin:8px 0;color:var(--muted);}
.text-display.markdown ul,.text-display.markdown ol{padding-left:24px;margin:8px 0;}
.text-display.markdown ul ul,.text-display.markdown ol ol,.text-display.markdown ul ol,.text-display.markdown ol ul{margin:4px 0;}
.text-display.markdown li{margin:4px 0;line-height:1.6;}
.text-display.markdown pre{background:var(--card);padding:12px;border-radius:6px;overflow-x:auto;margin:12px 0;}
.text-display.markdown code{background:var(--card);padding:2px 4px;border-radius:3px;font-size:0.9em;}
.text-display.markdown pre code{background:transparent;padding:0;}
.text-display.markdown table{width:100%;border-collapse:collapse;margin:16px 0;background:var(--card);border:1px solid var(--outline);border-radius:8px;overflow:hidden;}
.text-display.markdown table thead{background:var(--panel);}
.text-display.markdown table th{padding:8px 12px;text-align:left;border-bottom:2px solid var(--outline);font-weight:600;color:var(--text);}
.text-display.markdown table td{padding:8px 12px;border-bottom:1px solid var(--outline);}
.text-display.markdown table tbody tr:last-child td{border-bottom:none;}
.text-display.markdown table tbody tr:hover{background:rgba(79,174,74,0.05);}
.text-display.markdown blockquote{margin:12px 0;padding:8px 16px;border-left:4px solid var(--accent);background:rgba(79,174,74,0.1);color:var(--text);font-style:italic;}
.text-display.markdown a{color:var(--accent);text-decoration:none;}
.text-display.markdown a:hover{text-decoration:underline;}
.text-display.markdown img{max-width:100%;height:auto;border-radius:6px;margin:8px 0;}
.text-display.markdown hr{border:none;border-top:1px solid var(--outline);margin:16px 0;}
.text-display.markdown del{text-decoration:line-through;opacity:0.7;}
.text-display.markdown strong{font-weight:600;color:var(--text);}
.text-display.markdown em{font-style:italic;}
.text-display.markdown p{margin:12px 0;line-height:1.6;}
.text-display.json{background:var(--card);padding:12px;border-radius:6px;}
.text-display-loading{text-align:center;color:var(--muted);padding:32px;}
.text-display-error{background:rgba(239,68,68,0.1);border:1px solid var(--danger);color:var(--danger);padding:12px;border-radius:6px;}
.file-link{cursor:pointer;color:var(--accent);text-decoration:none;}
.file-link:hover{text-decoration:underline;}

/* Installer Wizard Modal */
.installer-wizard-modal{position:fixed;inset:0;z-index:100;display:flex;align-items:center;justify-content:center;}
.installer-modal{width:90%;max-width:600px;max-height:80vh;}
.installer-step{margin:16px 0;}
.installer-step h4{margin:0 0 8px;color:var(--text);font-size:16px;}
.installer-step p{margin:0 0 16px;color:var(--muted);line-height:1.5;}
.form-group{margin:16px 0;}
.form-group label{display:block;margin-bottom:6px;color:var(--text);font-size:14px;}
.form-group input[type="text"], .form-group textarea{width:100%;padding:8px 12px;background:var(--card);border:1px solid var(--outline);border-radius:6px;color:var(--text);font-size:14px;font-family:inherit;}
.form-group input[type="text"]:focus, .form-group textarea:focus{outline:none;border-color:var(--accent);}
.form-group input[type="checkbox"]{margin-right:8px;}
.form-group label:has(input[type="checkbox"]){display:flex;align-items:center;margin-bottom:8px;}
.selected-path{margin-top:12px;padding:8px 12px;background:var(--card);border:1px solid var(--outline);border-radius:6px;color:var(--accent);font-family:ui-monospace,monospace;font-size:13px;word-break:break-all;}
.btn-primary{background:var(--accent);color:white;border:1px solid var(--accent);font-weight:500;}
.btn-primary:hover{background:#45a040;}
.btn-primary:disabled{background:var(--muted);border-color:var(--muted);cursor:not-allowed;}
.modal-footer{display:flex;gap:8px;justify-content:flex-end;padding:12px 16px;border-top:1px solid var(--outline);background:var(--card);}
.summary-item{margin:12px 0;padding:8px 12px;background:var(--card);border-radius:6px;}
.summary-item strong{color:var(--text);}
.directory-list{margin:8px 0 0 16px;color:var(--text);}
.directory-list li{margin:4px 0;font-family:ui-monospace,monospace;font-size:13px;}
.progress-bar{width:100%;height:8px;background:var(--card);border-radius:4px;overflow:hidden;margin:12px 0;}
.progress-fill{height:100%;background:var(--accent);transition:width 0.3s ease;border-radius:4px;}
.install-progress{margin:16px 0;}
#progress-text{text-align:center;color:var(--muted);margin-top:8px;font-size:14px;}
.install-success{background:rgba(79,174,74,0.1);border:1px solid var(--accent);color:var(--accent);padding:16px;border-radius:8px;}
.install-success h4{margin:0 0 8px;color:var(--accent);}
.install-success p{margin:8px 0;line-height:1.5;}
.install-success code{background:var(--card);color:var(--text);}
.install-error{background:rgba(239,68,68,0.1);border:1px solid var(--danger);color:var(--danger);padding:16px;border-radius:8px;}
.install-error h4{margin:0 0 8px;color:var(--danger);}

/* Specs Management Window */
.specs-management-modal{position:fixed;inset:0;z-index:100;display:flex;align-items:center;justify-content:center;}
.specs-management-content{width:95%;max-width:1200px;height:85vh;max-height:800px;}
.specs-management-body{display:flex;flex-direction:column;height:100%;overflow:hidden;}

.specs-toolbar{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--outline);margin-bottom:12px;}
.toolbar-search{flex:1;max-width:300px;}
.toolbar-search input{width:100%;padding:8px 12px;background:var(--card);border:1px solid var(--outline);border-radius:6px;color:var(--text);font-size:14px;}
.toolbar-search input:focus{outline:none;border-color:var(--accent);}
.toolbar-filters{display:flex;gap:8px;}
.toolbar-filters select{padding:8px 12px;background:var(--card);border:1px solid var(--outline);border-radius:6px;color:var(--text);font-size:14px;}

.specs-layout{display:grid;grid-template-columns:1fr 1fr;gap:16px;flex:1;overflow:hidden;}
.specs-table-container{overflow:auto;border:1px solid var(--outline);border-radius:8px;background:var(--card);}
.specs-table{width:100%;border-collapse:collapse;font-size:13px;}
.specs-table th{background:var(--panel);color:var(--text);padding:10px 12px;text-align:left;border-bottom:2px solid var(--outline);font-weight:600;position:sticky;top:0;z-index:1;}
.specs-table th.sortable{cursor:pointer;user-select:none;position:relative;}
.specs-table th.sortable:hover{background:var(--card);}
.specs-table th.sortable::after{content:'↕';opacity:0.4;margin-left:6px;font-size:11px;}
.specs-table th.sortable.sort-asc::after{content:'↑';opacity:1;color:var(--accent);}
.specs-table th.sortable.sort-desc::after{content:'↓';opacity:1;color:var(--accent);}
.specs-table td{padding:8px 12px;border-bottom:1px solid var(--outline);color:var(--text);}
.specs-table tbody tr{cursor:pointer;transition:background-color 0.2s ease;}
.specs-table tbody tr:hover{background:rgba(79,174,74,0.05);}
.specs-table tbody tr.selected{background:rgba(79,174,74,0.1);}
.loading-row,.no-specs{text-align:center;color:var(--muted);padding:32px;font-style:italic;}

.specs-details-panel{border:1px solid var(--outline);border-radius:8px;background:var(--card);overflow:auto;}
.details-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--muted);}
.placeholder-icon{font-size:48px;margin-bottom:16px;opacity:0.5;}
.placeholder-text{font-size:16px;font-style:italic;}

.status-icon{font-size:16px;display:inline-block;width:20px;text-align:center;}
.progress-text{font-family:ui-monospace,monospace;font-size:12px;color:var(--muted);}
.effort-badge{display:inline-block;padding:2px 6px;border-radius:4px;font-size:11px;font-weight:500;background:var(--panel);border:1px solid var(--outline);}
.date-text{font-family:ui-monospace,monospace;font-size:12px;color:var(--muted);}

/* Enhanced Spec Details Panel */
.spec-details-content{padding:16px;height:100%;overflow-y:auto;}

.spec-details-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;padding-bottom:12px;border-bottom:1px solid var(--outline);}
.spec-details-title{margin:0;font-size:18px;color:var(--text);font-weight:600;}
.spec-status-badge{display:flex;align-items:center;gap:6px;padding:6px 12px;border-radius:6px;font-size:12px;font-weight:500;}
.spec-status-badge.completed{background:rgba(79,174,74,0.15);color:var(--accent);border:1px solid var(--accent);}
.spec-status-badge.in_progress{background:rgba(245,158,11,0.15);color:var(--warning);border:1px solid var(--warning);}
.spec-status-badge.pending{background:rgba(163,163,170,0.15);color:var(--muted);border:1px solid var(--muted);}

.section-title{font-size:14px;font-weight:600;color:var(--text);margin:0 0 12px 0;display:flex;align-items:center;}
.section-title::before{content:'';width:3px;height:16px;background:var(--accent);margin-right:8px;border-radius:2px;}

.spec-overview-section{margin-bottom:24px;}
.spec-metadata{display:grid;gap:8px;}
.metadata-item{display:flex;align-items:center;padding:8px 12px;background:var(--panel);border-radius:6px;}
.metadata-label{font-size:13px;color:var(--muted);min-width:80px;font-weight:500;}
.metadata-value{font-size:13px;color:var(--text);margin-left:auto;}
.metadata-value.spec-path{font-family:ui-monospace,monospace;font-size:11px;color:var(--muted);word-break:break-all;}

.spec-progress-section{margin-bottom:24px;}
.progress-metrics{display:grid;gap:16px;}
.progress-metric{background:var(--panel);padding:12px;border-radius:8px;}
.progress-metric-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.progress-metric-label{font-size:13px;color:var(--muted);font-weight:500;}
.progress-metric-value{font-size:13px;color:var(--text);font-family:ui-monospace,monospace;}
.progress-bar{width:100%;height:6px;background:var(--card);border-radius:3px;overflow:hidden;margin-bottom:4px;}
.progress-fill{height:100%;background:var(--accent);transition:width 0.3s ease;border-radius:3px;}
.progress-fill.effort-fill{background:var(--warning);}
.progress-percentage{font-size:11px;color:var(--muted);text-align:right;font-family:ui-monospace,monospace;}

.spec-tasks-section{margin-bottom:16px;}
.task-status-groups{display:grid;gap:16px;}
.task-status-group{background:var(--panel);border-radius:8px;overflow:hidden;}
.task-group-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--card);border-bottom:1px solid var(--outline);}
.task-group-title{font-size:14px;font-weight:600;color:var(--text);}
.task-group-count{font-size:12px;color:var(--muted);background:var(--panel);padding:2px 6px;border-radius:4px;}

.task-list{padding:8px;}
.task-item{margin-bottom:8px;padding:10px;background:var(--card);border-radius:6px;border-left:3px solid transparent;}
.task-item.completed{border-left-color:var(--accent);}
.task-item.in_progress{border-left-color:var(--warning);}
.task-item.pending{border-left-color:var(--muted);}
.task-item:last-child{margin-bottom:0;}

.task-item-header{display:flex;align-items:center;gap:8px;margin-bottom:6px;}
.task-status-icon{font-size:14px;width:16px;text-align:center;}
.task-name{font-size:13px;font-weight:500;color:var(--text);flex:1;}
.task-effort{font-size:10px;padding:2px 4px;}

.task-description{font-size:12px;color:var(--muted);line-height:1.4;margin-bottom:6px;}

.task-dependencies{font-size:11px;color:var(--muted);margin-bottom:4px;}
.dependencies-label{color:var(--muted);margin-right:4px;}
.dependencies-list{font-family:ui-monospace,monospace;color:var(--text);}

.task-completed-date{font-size:11px;color:var(--accent);font-family:ui-monospace,monospace;}

/* Responsive adjustments */
@media (max-width: 1024px) {
  .specs-layout{grid-template-columns:1fr;grid-template-rows:1fr 1fr;}
  .specs-management-content{width:98%;height:90vh;}
}
